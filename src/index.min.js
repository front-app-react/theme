"use strict";var e=require("./utilityColor.min.js"),t=require("./defaultFetch.min.js"),r=require("./checkSizing.min.js"),o=require("./colorHandler.min.js"),n=require("./getColorWithKeyCss.min.js"),i=require("react"),l=require("styled-components");function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e=function(e,t){if("object"!==c(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==c(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===c(e)?e:String(e)}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}require("@front-app-react/constants");let u=((g={})[g.lightest=-2]="lightest",g[g.lighter=-1]="lighter",g[g.default=0]="default",g[g.darker=1]="darker",g[g.darkest=2]="darkest",g);var g;class f{constructor(){s(this,"_data",{})}clear(){this.t={}}getItem(e){return this.t[e]}setItem(e,t){this.t[e]=t}removeItem(e){delete this.t[e]}get length(){return Object.getOwnPropertyNames(this.t).length}key(e){return Object.getOwnPropertyNames(this.t)[e]}}function y(e,t){var r,o=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)),o}function p(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?y(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const h={"theme.dir":"ltr","theme.locale":"en-US","theme.language":"english","theme.langLabel":"en"},d=(e,t,r)=>{const[o,n]=i.useState({dictionary:h,loading:!0});return{dictionary:o.dictionary,onChange:async i=>{let l;if(n((e=>p(p({},e),{},{loading:!0}))),"string"==typeof i)try{l=await r(i),console.log("lang async 1")}catch(i){}else l=i,console.log("lang 1");return t.setItem(e+"-lang",l?.["theme.locale"]||o.dictionary["theme.locale"]),n((e=>p(p({},e),{},{dictionary:l,loading:!1}))),console.log("lang async 2"),l||o.dictionary},loading:o.loading}};function b(e,t){var r,o=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)),o}function m(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?b(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):b(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const O=(t,r,o,n)=>{const[l,c]=i.useState({color:{data:{},name:""},sizing:"function"!=typeof n?n:{btn:{},input:{}},loadingSizing:"function"==typeof n,loadingColor:!0,loading:!0});i.useEffect((()=>{if("function"==typeof n)return c((e=>m(m({},e),{},{loadingSizing:!0}))),n().then((e=>{c((t=>m(m({},t),{},{loadingSizing:!1,sizing:e})))})).catch((e=>{c((e=>m(m({},e),{},{loadingSizing:!1})))})),()=>{}}),[]);var a=i.useCallback(((t,r,o)=>{if("transparent"===t)return"transparent";console.log({state:l});var n=e.convertRgb(l.color&&t?l.color.data[t]:"#000000");switch(o=void 0!==o?o:1,r){case 1:return e.lightenDarkenColor(n,-15,o);case 2:return e.lightenDarkenColor(n,-30,o);case-1:return e.lightenDarkenColor(n,15,o);case-2:return e.lightenDarkenColor(n,30,o);default:return e.lightenDarkenColor(n,0,o)}}),[l]);return m(m({},l),{},{onChange:async e=>{let n;if(c((e=>m(m({},e),{},{loadingColor:!0}))),"string"==typeof e)try{n=await o(e),console.log("color async 1")}catch(e){}else n=e,console.log("color 1");return r.setItem(t+"-color",n.name||l.color),c((e=>m(m({},e),{},{color:n,loadingColor:!1}))),console.log("color async 2"),n||l.color},getColor:a,loading:l.loadingColor&&l.loadingSizing})};function j(e,t){if(null==e)return{};var r,o=function(e,t){if(null==e)return{};for(var r,o={},n=Object.keys(e),i=0;i<n.length;i++)r=n[i],0<=t.indexOf(r)||(o[r]=e[r]);return o}(e,t);if(Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),i=0;i<n.length;i++)r=n[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r]);return o}const C=["children","prefix","storage","defaultLang","defaultColor","defaultSizing"];exports.convertRgb=e.convertRgb,exports.lightenDarkenColor=e.lightenDarkenColor,exports.defaultFetch=t.defaultFetch,exports.checkSizing=r.checkSizing,exports.colorHandler=o.colorHandler,exports.getColorWithKeyCss=n.getColorWithKeyCss,exports.IMoodColor=u,exports.ThemeProvider=e=>{let{children:r,prefix:o,storage:n=new f,defaultLang:c,defaultColor:a,defaultSizing:s}=e,u=j(e,C);const g=O(o,n,"function"!=typeof a||"string"==typeof a?e=>t.defaultFetch(e,"color"):a,void 0===s?()=>t.defaultFetch("sizing"):s),y=d(o,n,"function"!=typeof c||"string"==typeof c?e=>t.defaultFetch(e,"lang"):c);return i.useEffect((()=>((async()=>{var e=n.getItem(o+"-lang"),t=n.getItem(o+"-color");e?y.onChange(e):"object"==typeof c&&c.fetch&&"function"==typeof c.fetch?(e=await c.fetch(c.value),y.onChange(e)):y.onChange(c),t?g.onChange(t):"object"==typeof(e=a)&&e.fetch&&"function"==typeof e.fetch?(t=await e.fetch(e.value),g.onChange(t)):g.onChange(e)})(),()=>{})),[]),i.createElement(l.ThemeProvider,{theme:{style:g,lang:y,others:u}},r)},exports.ThemeStorage=f,exports.useLang=d,exports.useStyle=O,exports.useTheme=()=>i.useContext(l.ThemeContext);
