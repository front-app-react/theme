"use strict";var e=require("react"),t=require("styled-components");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e){return e=function(e,t){if("object"!==r(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0===n)return("string"===t?String:Number)(e);if("object"!==r(n=n.call(e,t||"default")))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===r(e)?e:String(e)}function o(e,t,r){return(t=n(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let i=((a={})[a.lightest=-2]="lightest",a[a.lighter=-1]="lighter",a[a.default=0]="default",a[a.darker=1]="darker",a[a.darkest=2]="darkest",a);var a;class c{constructor(){o(this,"_data",{})}clear(){this.t={}}getItem(e){return this.t[e]}setItem(e,t){this.t[e]=t}removeItem(e){delete this.t[e]}get length(){return Object.getOwnPropertyNames(this.t).length}key(e){return Object.getOwnPropertyNames(this.t)[e]}}function l(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);e=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/i.exec(e);let r=0,n=0,o=0;return t&&4===t.length?(r=parseInt(t[1],16),n=parseInt(t[2],16),o=parseInt(t[3],16)):e&&4<=e.length&&(r=parseInt(e[1]),n=parseInt(e[2]),o=parseInt(e[3])),{r:r,g:n,b:o}}function s(e,t,r){let{r:n,g:o,b:i}=e;return 255<(n+=t)?n=255:n<0&&(n=0),255<(o=(255&o)+t)?o=255:o<0&&(o=0),255<(i=(255&i)+t)?i=255:i<0&&(i=0),`rgba(${n},${o},${i},${r})`}const g=async(e,t)=>("sizing"===e?await fetch(process.env.PUBLIC_URL+"/theme/sizing.json"):"color"===t?await fetch(process.env.PUBLIC_URL+`/theme/colors/${e}.json`):await fetch(process.env.PUBLIC_URL+`/langs/${e}.json`)).json();function u(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const p={"theme.dir":"ltr","theme.locale":"en-US","theme.language":"english","theme.langLabel":"en"},y=(t,r,n)=>{const[o,i]=e.useState({dictionary:p,loading:!0});return{dictionary:o.dictionary,onChange:async e=>{let a;if(i((e=>f(f({},e),{},{loading:!0}))),"string"==typeof e)try{a=await n(e),console.log("lang async 1")}catch(e){}else a=e,console.log("lang 1");return r.setItem(t+"-lang",a?.["theme.locale"]||o.dictionary["theme.locale"]),i((e=>f(f({},e),{},{dictionary:a,loading:!1}))),console.log("lang async 2"),a||o.dictionary},loading:o.loading}};function h(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function d(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?h(Object(r),!0).forEach((function(t){o(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const b=(t,r,n,o)=>{const[i,a]=e.useState({color:{data:{},name:""},sizing:"function"!=typeof o?o:{btn:{},input:{}},loadingSizing:"function"==typeof o,loadingColor:!0,loading:!0});e.useEffect((()=>{if("function"==typeof o)return a((e=>d(d({},e),{},{loadingSizing:!0}))),o().then((e=>{a((t=>d(d({},t),{},{loadingSizing:!1,sizing:e})))})).catch((e=>{a((e=>d(d({},e),{},{loadingSizing:!1})))})),()=>{}}),[]);var c=e.useCallback(((e,t,r)=>{if("transparent"===e)return"transparent";console.log({state:i});var n=l(i.color&&e?i.color.data[e]:"#000000");switch(r=void 0!==r?r:1,t){case 1:return s(n,-15,r);case 2:return s(n,-30,r);case-1:return s(n,15,r);case-2:return s(n,30,r);default:return s(n,0,r)}}),[i]);return d(d({},i),{},{onChange:async e=>{let o;if(a((e=>d(d({},e),{},{loadingColor:!0}))),"string"==typeof e)try{o=await n(e),console.log("color async 1")}catch(e){}else o=e,console.log("color 1");return r.setItem(t+"-color",o.name||i.color),a((e=>d(d({},e),{},{color:o,loadingColor:!1}))),console.log("color async 2"),o||i.color},getColor:c,loading:i.loadingColor&&i.loadingSizing})};exports.IMoodColor=i,exports.ThemeProvider=({children:r,prefix:n,storage:o=new c,defaultLang:i,defaultColor:a,defaultSizing:l})=>{const s=b(n,o,"function"!=typeof a||"string"==typeof a?e=>g(e,"color"):a,void 0===l?()=>g("sizing"):l),u=y(n,o,"function"!=typeof i||"string"==typeof i?e=>g(e,"lang"):i);return e.useEffect((()=>((async()=>{var e=o.getItem(n+"-lang"),t=o.getItem(n+"-color");e?u.onChange(e):"object"==typeof i&&i.fetch&&"function"==typeof i.fetch?(e=await i.fetch(i.value),u.onChange(e)):u.onChange(i),t?s.onChange(t):"object"==typeof(e=a)&&e.fetch&&"function"==typeof e.fetch?(t=await e.fetch(e.value),s.onChange(t)):s.onChange(e)})(),()=>{})),[]),e.createElement(t.ThemeProvider,{theme:{style:s,lang:u}},r)},exports.ThemeStorage=c,exports.convertRgb=l,exports.defaultFetch=g,exports.lightenDarkenColor=s,exports.useLang=y,exports.useStyle=b,exports.useTheme=()=>e.useContext(t.ThemeContext);
