"use strict";var e=require("./utilityColor.min.js"),t=require("./defaultFetch.min.js"),r=require("./checkSizing.min.js"),n=require("./colorHandler.min.js"),o=require("./getColorWithKeyCss.min.js"),i=require("react"),c=require("styled-components");function l(e){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e){return e=function(e,t){if("object"!==l(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==l(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===l(e)?e:String(e)}function s(e,t,r){return(t=a(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}require("@front-app-react/constants");let u=((f={})[f.lightest=-2]="lightest",f[f.lighter=-1]="lighter",f[f.default=0]="default",f[f.darker=1]="darker",f[f.darkest=2]="darkest",f);var f;class g{constructor(){s(this,"_data",{})}clear(){this.t={}}getItem(e){return this.t[e]}setItem(e,t){this.t[e]=t}removeItem(e){delete this.t[e]}get length(){return Object.getOwnPropertyNames(this.t).length}key(e){return Object.getOwnPropertyNames(this.t)[e]}}function p(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function y(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const h={"theme.dir":"ltr","theme.locale":"en-US","theme.language":"english","theme.langLabel":"en"},b=(e,t,r)=>{const[n,o]=i.useState({dictionary:h,loading:!0});return{dictionary:n.dictionary,onChange:async i=>{let c;if(o((e=>y(y({},e),{},{loading:!0}))),"string"==typeof i)try{c=await r(i)}catch(i){}else c=i;return t.setItem(e+"-lang",c?.["theme.locale"]||n.dictionary["theme.locale"]),o((e=>y(y({},e),{},{dictionary:c,loading:!1}))),c||n.dictionary},loading:n.loading}};function d(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function O(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?d(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const m=(t,r,n,o)=>{const[c,l]=i.useState({color:{data:{},name:""},sizing:"function"!=typeof o?o:{btn:{},input:{}},loadingSizing:"function"==typeof o,loadingColor:!0,loading:!0});i.useEffect((()=>{if("function"==typeof o)return l((e=>O(O({},e),{},{loadingSizing:!0}))),o().then((e=>{l((t=>O(O({},t),{},{loadingSizing:!1,sizing:e})))})).catch((e=>{l((e=>O(O({},e),{},{loadingSizing:!1})))})),()=>{}}),[]);var a=i.useCallback(((t,r,n)=>{if("transparent"===t)return"transparent";var o=e.convertRgb(c.color&&t?c.color.data[t]:"#000000");switch(n=void 0!==n?n:1,r){case 1:return e.lightenDarkenColor(o,-15,n);case 2:return e.lightenDarkenColor(o,-30,n);case-1:return e.lightenDarkenColor(o,15,n);case-2:return e.lightenDarkenColor(o,30,n);default:return e.lightenDarkenColor(o,0,n)}}),[c]);return O(O({},c),{},{onChange:async e=>{let o;if(l((e=>O(O({},e),{},{loadingColor:!0}))),"string"==typeof e)try{o=await n(e)}catch(e){}else o=e;return r.setItem(t+"-color",o.name||c.color),l((e=>O(O({},e),{},{color:o,loadingColor:!1}))),o||c.color},getColor:a,loading:c.loadingColor&&c.loadingSizing})};function j(e,t){if(null==e)return{};var r,n=function(e,t){if(null==e)return{};for(var r,n={},o=Object.keys(e),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(e),i=0;i<o.length;i++)r=o[i],0<=t.indexOf(r)||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r]);return n}const v=["children","prefix","storage","defaultLang","defaultColor","defaultSizing"];function C(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)),n}function P(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?C(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}exports.convertRgb=e.convertRgb,exports.lightenDarkenColor=e.lightenDarkenColor,exports.defaultFetch=t.defaultFetch,exports.checkSizing=r.checkSizing,exports.colorHandler=n.colorHandler,exports.getColorWithKeyCss=o.getColorWithKeyCss,exports.IMoodColor=u,exports.ThemeProvider=e=>{let{children:r,prefix:n,storage:o=new g,defaultLang:l,defaultColor:a,defaultSizing:s}=e,u=j(e,v);const f=m(n,o,"function"!=typeof a||"string"==typeof a?e=>t.defaultFetch(e,"color"):a,void 0===s?()=>t.defaultFetch("sizing"):s),p=b(n,o,"function"!=typeof l||"string"==typeof l?e=>t.defaultFetch(e,"lang"):l);return i.useEffect((()=>((async()=>{var e=o.getItem(n+"-lang"),t=o.getItem(n+"-color");e?p.onChange(e):"object"==typeof l&&l.fetch&&"function"==typeof l.fetch?(e=await l.fetch(l.value),p.onChange(e)):p.onChange(l),t?f.onChange(t):"object"==typeof(e=a)&&e.fetch&&"function"==typeof e.fetch?(t=await e.fetch(e.value),f.onChange(t)):f.onChange(e)})(),()=>{})),[]),i.createElement(c.ThemeProvider,{theme:P({style:f,lang:p},u)},r)},exports.ThemeStorage=g,exports.useLang=b,exports.useStyle=m,exports.useTheme=()=>i.useContext(c.ThemeContext);
