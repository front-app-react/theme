"use strict";var e=require("react"),t=require("./utilityColor.min.js"),r=require("styled-components"),o=require("./defaultFetch.min.js");function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e){return e=function(e,t){if("object"!==n(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0===r)return("string"===t?String:Number)(e);if("object"!==n(r=r.call(e,t||"default")))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}(e,"string"),"symbol"===n(e)?e:String(e)}function l(e,t,r){return(t=i(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}let c=((a={})[a.lightest=-2]="lightest",a[a.lighter=-1]="lighter",a[a.default=0]="default",a[a.darker=1]="darker",a[a.darkest=2]="darkest",a);var a;class s{constructor(){l(this,"_data",{})}clear(){this.t={}}getItem(e){return this.t[e]}setItem(e,t){this.t[e]=t}removeItem(e){delete this.t[e]}get length(){return Object.getOwnPropertyNames(this.t).length}key(e){return Object.getOwnPropertyNames(this.t)[e]}}function u(e,t){var r,o=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)),o}function g(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const f={"theme.dir":"ltr","theme.locale":"en-US","theme.language":"english","theme.langLabel":"en"},y=(t,r,o)=>{const[n,i]=e.useState({dictionary:f,loading:!0});return{dictionary:n.dictionary,onChange:async e=>{let l;if(i((e=>g(g({},e),{},{loading:!0}))),"string"==typeof e)try{l=await o(e),console.log("lang async 1")}catch(e){}else l=e,console.log("lang 1");return r.setItem(t+"-lang",l?.["theme.locale"]||n.dictionary["theme.locale"]),i((e=>g(g({},e),{},{dictionary:l,loading:!1}))),console.log("lang async 2"),l||n.dictionary},loading:n.loading}};function p(e,t){var r,o=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,r)),o}function h(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(Object(r),!0).forEach((function(t){l(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const d=(r,o,n,i)=>{const[l,c]=e.useState({color:{data:{},name:""},sizing:"function"!=typeof i?i:{btn:{},input:{}},loadingSizing:"function"==typeof i,loadingColor:!0,loading:!0});e.useEffect((()=>{if("function"==typeof i)return c((e=>h(h({},e),{},{loadingSizing:!0}))),i().then((e=>{c((t=>h(h({},t),{},{loadingSizing:!1,sizing:e})))})).catch((e=>{c((e=>h(h({},e),{},{loadingSizing:!1})))})),()=>{}}),[]);var a=e.useCallback(((e,r,o)=>{if("transparent"===e)return"transparent";console.log({state:l});var n=t.convertRgb(l.color&&e?l.color.data[e]:"#000000");switch(o=void 0!==o?o:1,r){case 1:return t.lightenDarkenColor(n,-15,o);case 2:return t.lightenDarkenColor(n,-30,o);case-1:return t.lightenDarkenColor(n,15,o);case-2:return t.lightenDarkenColor(n,30,o);default:return t.lightenDarkenColor(n,0,o)}}),[l]);return h(h({},l),{},{onChange:async e=>{let t;if(c((e=>h(h({},e),{},{loadingColor:!0}))),"string"==typeof e)try{t=await n(e),console.log("color async 1")}catch(e){}else t=e,console.log("color 1");return o.setItem(r+"-color",t.name||l.color),c((e=>h(h({},e),{},{color:t,loadingColor:!1}))),console.log("color async 2"),t||l.color},getColor:a,loading:l.loadingColor&&l.loadingSizing})};exports.IMoodColor=c,exports.ThemeProvider=({children:t,prefix:n,storage:i=new s,defaultLang:l,defaultColor:c,defaultSizing:a})=>{const u=d(n,i,"function"!=typeof c||"string"==typeof c?e=>o.defaultFetch(e,"color"):c,void 0===a?()=>o.defaultFetch("sizing"):a),g=y(n,i,"function"!=typeof l||"string"==typeof l?e=>o.defaultFetch(e,"lang"):l);return e.useEffect((()=>((async()=>{var e=i.getItem(n+"-lang"),t=i.getItem(n+"-color");e?g.onChange(e):"object"==typeof l&&l.fetch&&"function"==typeof l.fetch?(e=await l.fetch(l.value),g.onChange(e)):g.onChange(l),t?u.onChange(t):"object"==typeof(e=c)&&e.fetch&&"function"==typeof e.fetch?(t=await e.fetch(e.value),u.onChange(t)):u.onChange(e)})(),()=>{})),[]),e.createElement(r.ThemeProvider,{theme:{style:u,lang:g}},t)},exports.ThemeStorage=s,exports.useLang=y,exports.useStyle=d,exports.useTheme=()=>e.useContext(r.ThemeContext);
